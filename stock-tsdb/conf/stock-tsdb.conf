# 股票行情数据TSDB系统配置文件

[server]
# Redis接口端口
port = 6379
# 绑定地址
bind = 127.0.0.1
# 最大连接数
max_connections = 1000
# 使用事件驱动服务器 (lzmq-ffi)
use_event_driver = true

[storage]
# 数据存储目录
data_dir = ./data
# 日志目录
log_dir = ./logs
# 数据块大小(秒)
block_size = 30
# 压缩级别(1-22, 数字越大压缩率越高)
compression_level = 6
# 是否启用压缩
enable_compression = true
# 内存映射文件大小(MB)
mmap_size = 1024
# 写缓冲区大小(MB)
write_buffer_size = 64
# 最大写缓冲区数
max_write_buffer_number = 4

[rocksdb]
# RocksDB配置
# 每个ColumnFamily的写缓冲区大小
write_buffer_size = 64MB
# 最大文件大小
max_file_size = 128MB
# 目标文件大小基数
target_file_size_base = 64MB
# 目标文件大小倍数
target_file_size_multiplier = 2
# 最大后台压缩线程数
max_background_compactions = 8
# 最大后台刷新线程数
max_background_flushes = 4
# 块缓存大小
block_cache_size = 512MB
# 是否启用统计信息
enable_statistics = true
# 统计信息转储周期(秒)
stats_dump_period_sec = 600

[cluster]
# ZeroMQ集群配置
# 节点ID(0表示主节点)
node_id = 0
# 集群模式: single, master, slave
cluster_mode = single
# 主节点地址(集群模式下)
master_host = 127.0.0.1
# 主节点端口
master_port = 5555
# 心跳间隔(秒)
heartbeat_interval = 30
# 复制超时时间(秒)
replication_timeout = 60
# 最大重试次数
max_retry = 3

[data_retention]
# 数据保留策略
# 热数据保留天数(不压缩)
hot_data_days = 7
# 温数据保留天数(轻压缩)
warm_data_days = 30
# 冷数据保留天数(高压缩)
cold_data_days = 365
# 是否自动删除过期数据
auto_cleanup = true
# 清理检查间隔(小时)
cleanup_interval = 24

[performance]
# 性能优化参数
# 批量写入大小
batch_size = 1000
# 查询缓存大小
query_cache_size = 10000
# 写入限速(点/秒，0表示不限速)
write_rate_limit = 0
# 查询并发数
query_concurrency = 8
# 是否启用预读取
enable_prefetch = true

[monitoring]
# 监控配置
# 是否启用监控
enable_monitoring = true
# 监控端口
monitor_port = 8080
# 监控数据保留时间(小时)
monitor_retention = 24
# 告警阈值
write_qps_threshold = 50000
query_latency_threshold = 100
error_rate_threshold = 0.01

[logging]
# 日志配置
# 日志级别: debug, info, warn, error
log_level = info
# 日志文件大小(MB)
max_log_size = 100
# 日志文件保留天数
log_retention_days = 7
# 是否启用控制台日志
enable_console_log = true
# 是否启用文件日志
enable_file_log = true

[market]
# 市场配置
# 支持的市场列表
markets = sh,sz,hk,us
# 每个市场的RocksDB实例配置
[market.sh]
name = 上海证券交易所
data_dir = ./data/sh
compression = lz4

[market.sz]
name = 深圳证券交易所
data_dir = ./data/sz
compression = lz4

[market.hk]
name = 香港交易所
data_dir = ./data/hk
compression = zstd

[market.us]
name = 美国交易所
data_dir = ./data/us
compression = zstd