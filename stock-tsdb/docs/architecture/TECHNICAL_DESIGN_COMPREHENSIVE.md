# Stock-TSDB æŠ€æœ¯è®¾è®¡ç»¼åˆæ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£æ•´åˆäº†é¡¹ç›®ç ”ç©¶é˜¶æ®µçš„å…¨éƒ¨æŠ€æœ¯æ–¹æ¡ˆå’Œè®¾è®¡æ€è·¯ï¼Œä¸º Stock-TSDB æ—¶åºæ•°æ®åº“æä¾›å®Œæ•´çš„æŠ€æœ¯å‚è€ƒã€‚

## ğŸ¯ æ ¸å¿ƒè®¾è®¡ç›®æ ‡

- **å¾®ç§’çº§ç²¾åº¦**: æ”¯æŒè‚¡ç¥¨è¡Œæƒ…æ•°æ®çš„å¾®ç§’çº§æ—¶é—´æˆ³
- **é«˜æ€§èƒ½å†™å…¥**: å•èŠ‚ç‚¹æ”¯æŒ 500ä¸‡+ ç‚¹/ç§’å†™å…¥
- **ä½å»¶è¿ŸæŸ¥è¯¢**: P99 æŸ¥è¯¢å»¶è¿Ÿ < 1ms
- **å†·çƒ­åˆ†ç¦»**: è‡ªåŠ¨æ•°æ®ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **åˆ†å¸ƒå¼æ”¯æŒ**: æ”¯æŒé›†ç¾¤éƒ¨ç½²å’Œé«˜å¯ç”¨

---

## 1ï¸âƒ£ æŠ€æœ¯å¤ç”¨æ–¹æ¡ˆ

### é€šç”¨æ—¶åºæ•°æ®å­˜å‚¨æ¨¡æ¿

æˆ‘ä»¬çš„ "30ç§’å®šé•¿å— + å¾®ç§’åˆ—åç§»" è®¾è®¡å¯ä»¥é›¶æ”¹åŠ¨å¤ç”¨åˆ°å¤šä¸ªé¢†åŸŸï¼š

#### ğŸ–¥ï¸ æœåŠ¡å™¨ç³»ç»Ÿç›‘æ§
| åŸè‚¡ç¥¨å­—æ®µ | æ˜ å°„ä¸ºç›‘æ§å­—æ®µ | å­—èŠ‚é•¿åº¦ | ç¤ºä¾‹ |
|---|---|---|---|
| market | æœºæˆ¿ä»£å· | 1B | 'B' = åŒ—äº¬ |
| code | ä¸»æœº+æŒ‡æ ‡ | 9B | "srv001cpu" |
| ts_us | é‡‡é›†æ—¶é—´Î¼s | 8B | 1696843845123456 |
| value | é‡‡æ ·å€¼ | 50B | å®šé•¿æµ®ç‚¹+æ ‡ç­¾ |

**æ€§èƒ½æŒ‡æ ‡**: å•æ ¸ 400ä¸‡ç‚¹/ç§’å†™å…¥ï¼ŒæŸ¥è¯¢P99 < 0.3ms

#### ğŸ³ K8s Pod æ€§èƒ½æŒ‡æ ‡
- æ›¿ä»£ Prometheus TSDBï¼Œ**ç£ç›˜èŠ‚çœ60%**ï¼ˆå®šé•¿+LZ4ï¼‰
- æ”¯æŒä»»æ„æ ‡ç­¾ç»´åº¦ä¸‹é’»
- codeå­—æ®µä½¿ç”¨å“ˆå¸Œ: `left(sha256(namespace/pod/container/metric), 9)`

#### ğŸ“¡ IoT ä¼ æ„Ÿå™¨æ•°æ®
- 10åˆ†é’Ÿå¯¹é½å—ï¼Œæ”¯æŒ6Mç‚¹é¡ºåºå†™
- æœºé¡¶ç›’çº§MCU 1MBå†…å­˜å›æ”¾
- æŒ‰è®¾å¤‡+æ—¶é—´æ®µæ‰¹é‡æ‹‰å–ï¼ŒIteratoråªæ‰«1ä¸ªSST

#### ğŸ”§ é€šç”¨æ¨¡æ¿å…¬å¼
```
RowKey(18B) = dimension_hash(10B) + chunk_base_ms(8B)
Qualifier(6B) = offset_in_chunk(4B) + seq(2B)
Value(50B) = å®šé•¿æµ®ç‚¹/è®¡æ•°/æ ‡ç­¾
```

---

## 2ï¸âƒ£ ä¸¤å¥—æ ¸å¿ƒæ–¹æ¡ˆ

### ğŸ“Š æ–¹æ¡ˆA: ã€Œåˆ†å— + åˆ—åç§»ã€- è¡Œæƒ…å®ç›˜é¦–é€‰

```
RowKey: metric|tagv1|tagv2|chunk_base_sec  // å®šé•¿36B
chunk_base_sec = å¾®ç§’æ—¶é—´/1e6å‘ä¸‹å–30så¯¹é½

Qualifier: micro_offset(4B) + seq(2B)  // 6B
micro_offset = å¾®ç§’æ—¶é—´ - chunk_base_sec*1_000_000
```

**ç‰¹ç‚¹**:
- âœ… 30sä¸€å—ï¼Œå•å—æœ€å¤š30Mç¬”ï¼Œå‹ç¼©åâ‰¤8MB
- âœ… è¯»æœ€è¿‘1åˆ†é’Ÿæ•°æ®â†’æœ€å¤š2ä¸ªNext
- âœ… å•æœº16çº¿ç¨‹580ä¸‡ç¬”/så†™ï¼ŒP99è¯»0.6ms

### ğŸ“ˆ æ–¹æ¡ˆB: ã€Œæ—¶é—´åˆ†å±‚ + å€’åºã€- é«˜é¢‘åå‘å›æ‰«

```
RowKey: metric|tagv1|tagv2|day(4B)|bucket_10ms(3B)  // å›ºå®š20B
Qualifier: micros_in_bucket(2B)  // 0-9999Î¼såç§»
```

**ç‰¹ç‚¹**:
- âœ… åå‘æ‰«10sæ•°æ®â†’å®šä½åˆ°1000ä¸ª10msæ¡¶
- âœ… å»¶è¿Ÿå†é™30%
- âŒ å‹ç¼©ç‡é™40%ï¼Œç£ç›˜ç¿»å€

### ğŸ¯ æ–¹æ¡ˆé€‰æ‹©å»ºè®®
> **å¾®ç§’æ—¶é—´ç»å¯¹ä¸è¦è£¸æ‹¼åœ¨RowKeyæœ€å‰é¢**ï¼›**"å°æ—¶/åˆ†é’ŸåŸºçº¿"æ”¾Keyï¼Œå¾®ç§’æ”¾åˆ—åç§»**ï¼Œæ‰æ˜¯å…¼é¡¾"ç²¾åº¦"ä¸"æ€§èƒ½"çš„æ­£è§„åšæ³•ã€‚

---

## 3ï¸âƒ£ æŠ€æœ¯å®ç°ç»†èŠ‚

### ğŸ“‹ çœŸå®è¡Œæƒ…æ•°æ®è½ç›˜æµç¨‹

**åŸå§‹è¡Œæƒ…** (é€ç¬”æˆäº¤):
| å­—æ®µ | å€¼ |
|---|---|
| å¸‚åœº | æ²ªæ·± â†’ 'S' |
| ä»£ç  | 600000 |
| æˆäº¤æ—¶é—´ | 2023-10-09 14:30:45.123456 (å¾®ç§’æˆ³ 1696843845123456) |
| åºå· | æœ¬å¾®ç§’ç¬¬3ç¬” â†’ seq=2 |
| ä»·æ ¼ | 10.12å…ƒ â†’ 101200 (1/10000å…ƒ) |
| æ•°é‡ | 300è‚¡ |
| é€šé“ | 7 |
| ä¹°å–æ–¹å‘ | ä¹°å…¥ â†’ 'B' |
| è®¢å•å· | 1234567890123456 |
| æˆäº¤åºå· | 9876543210987654 |

### ğŸ§® æ´¾ç”Ÿå­—æ®µè®¡ç®—
```
chunk_base_ms = 1696843845123456/1e6/30/1000*30*1000 = 1696843824000 (30så¯¹é½)
micro_offset = 1696843845123456 - 1696843824000*1000 = 2123456Î¼s
ä»·æ ¼ç¼–ç  = 10.12*10000 = 101200
```

### ğŸ”§ äºŒè¿›åˆ¶æ‰“åŒ… (å¤§ç«¯)
```
RowKey(18B):
53 30 30 30 30 30 36 30 30 00 00 01 89 E7 49 C0 00
â”‚â””--------code9-----------â”˜â””----chunk_base_ms BE----â”˜

Qualifier(6B):
00 20 6D 20 00 02
â””--micro_offset=2123456 BE-â”˜â””seqâ”˜

Value(50B):
00 01 8D 50 00 00 01 2C 07 00 00 00 00 11 22 33 44 55 66 00 00 00 00 88 77 66 55 44 33 22 10 00...00
â””price---â”˜â””qty----â”˜â”‚â””--order_no BE--â”˜â””----tick_no BE----â”˜â””24B 0â”˜
```

### ğŸ’¾ RocksDBè½ç›˜æµç¨‹
1. **MemTable** (SkipList): Keyå‰18Bç›¸åŒï¼Œè·³è¡¨åªæ¯”è¾ƒä¸€æ¬¡å‰ç¼€å°±æ’å…¥å°¾éƒ¨
2. **WAL**: æ¯1msè°ƒç”¨`FlushWAL(true)`ï¼Œå®•æœºæœ€å¤šä¸¢1ms
3. **Flushâ†’L0 SST**: MemTableè¾¾256MBåæ•´å—åˆ·ç›˜ï¼ŒLZ4å‹ç¼©å55Bå·¦å³
4. **Compaction L0â†’L1**: å¤šè·¯å½’å¹¶ï¼Œé›¶å†™æ”¾å¤§ï¼Œå‹ç¼©ç‡4:1

### ğŸ” è¯»æµç¨‹ (ç‚¹æŸ¥æŸå¾®ç§’)
1. å®¢æˆ·ç«¯å‘`GET S 600000 1696843845123456 2`
2. æœåŠ¡ç«¯ç®—åŒä¸€å¥—`chunk_base_ms`+`micro_offset`+`seq`ï¼Œæ‹¼å‡º24B Key
3. RocksDBå…ˆæŸ¥BlockCacheâ†’å‘½ä¸­ç›´æ¥è¿”å›50B Value (~0.05ms)
4. æœªå‘½ä¸­â†’ä¸€æ¬¡ç£ç›˜read(74B)â†’å¡«ç¼“å­˜â†’è¿”å› (~0.4ms)

### ğŸ”§ äºŒè¿›åˆ¶ç»“æ„å®šä¹‰ (æ–¹æ¡ˆAè¯¦ç»†è§„æ ¼)

#### RowKeyç»“æ„ (18Bå®šé•¿)
| å­—æ®µ | é•¿åº¦ | ç±»å‹ | å­—èŠ‚åº | è¯´æ˜ |
|---|---|---|---|---|
| market | 1B | uint8 | - | 'S'=æ²ªæ·± 'H'=æ¸¯è‚¡ 'U'=ç¾è‚¡ |
| code | 9B | ASCII | - | å³å¯¹é½è¡¥0ï¼Œå¦‚600000â†’"000000600" |
| chunk_base_ms | 8B | uint64 | å¤§ç«¯ | 30så¯¹é½æ¯«ç§’æ—¶é—´ |

#### Qualifierç»“æ„ (6Bå®šé•¿)
| å­—æ®µ | é•¿åº¦ | ç±»å‹ | å­—èŠ‚åº | è®¡ç®—æ–¹å¼ |
|---|---|---|---|---|
| micro_offset | 4B | uint32 | å¤§ç«¯ | `ts_us - chunk_base_ms*1000` |
| seq | 2B | uint16 | å¤§ç«¯ | åŒä¸€å¾®ç§’å†…é‡å¤ç¬”åºå·ï¼Œä»0å¼€å§‹ |

#### Valueç»“æ„ (50Bå®šé•¿)
| å­—æ®µ | é•¿åº¦ | ç±»å‹ | ç²¾åº¦/æ ¼å¼ | è¯´æ˜ |
|---|---|---|---|---|
| price | 4B | int32 | 1/10000å…ƒ | 9999.9999â†’99999999 |
| qty | 4B | uint32 | è‚¡ | æœ€å¤§42.9äº¿è‚¡ |
| channel | 1B | uint8 | - | é€šé“å·0-255 |
| side | 1B | uint8 | - | 'B'/'S'/'N' å­˜æˆ0/1/2 |
| order_no | 8B | uint64 | å¤§ç«¯ | äº¤æ˜“æ‰€åŸå§‹è®¢å•å· |
| tick_no | 8B | uint64 | å¤§ç«¯ | äº¤æ˜“æ‰€åŸå§‹æˆäº¤åºå· |
| reserved | 24B | raw | - | è¡¥0ï¼Œç•™ç»™é£æ§æ‰“æ ‡ç­¾ |

#### æ‰“åŒ…/è§£åŒ…ä»£ç  (Cç‰ˆï¼ŒLua FFIå¯ç›´æ¥ç”¨)
```c
/* æ‰“åŒ… Key + Qual */
void pack_key_qual(uint8_t *out18, char market, const char *code9, uint64_t chunk_base_ms) {
    out18[0] = market;
    memcpy(out18+1, code9, 9);              // ASCII æ— éœ€è½¬
    chunk_base_ms = htobe64(chunk_base_ms); // å¤§ç«¯
    memcpy(out18+10, &chunk_base_ms, 8);
}

void pack_qual(uint8_t *out6, uint32_t micro_off, uint16_t seq) {
    micro_off = htobe32(micro_off);
    seq       = htobe16(seq);
    memcpy(out6,   &micro_off, 4);
    memcpy(out6+4, &seq,       2);
}

/* æ‰“åŒ… Value */
void pack_value(uint8_t *out50, int32_t price, uint32_t qty, uint8_t ch, uint8_t side,
                uint64_t order_no, uint64_t tick_no) {
    price   = htobe32(price);
    qty     = htobe32(qty);
    order_no = htobe64(order_no);
    tick_no  = htobe64(tick_no);
    memcpy(out50+0,  &price,    4);
    memcpy(out50+4,  &qty,      4);
    out50[8]  = ch;
    out50[9]  = side;
    memcpy(out50+10, &order_no, 8);
    memcpy(out50+18, &tick_no,  8);
    memset(out50+26, 0, 24);   // reserved
}
```

**è®¾è®¡ä¼˜åŠ¿**:
- âœ… **å®šé•¿è®¾è®¡**: æ•´ä½“<74Bï¼ŒRocksDBç´¢å¼•å—100%å†…å­˜å‘½ä¸­
- âœ… **å‰ç¼€å‹ç¼©**: RowKey18Bå®šé•¿å‰ç¼€ï¼Œå‹ç¼©ç‡4:1
- âœ… **é›¶æ‹·è´**: ç›´æ¥å†…å­˜æ“ä½œï¼Œé¡ºåºå†™æ”¾å¤§<1.2
- âœ… **é«˜æ€§èƒ½**: æ”¯æŒ720ä¸‡ops/sçš„æ ¸å¿ƒæŠ€æœ¯

---

## 4ï¸âƒ£ æ¶æ„è®¾è®¡æ–¹æ¡ˆ

### ğŸ—ï¸ æ•´ä½“æ¶æ„

```
+----------------+     +-----------------+     +-----------------+
| è¡Œæƒ…æ•°æ®ç”Ÿäº§è€…  | --> | ZeroMQ Router   | --> | è®¡ç®—èŠ‚ç‚¹é›†ç¾¤     |
| (äº¤æ˜“æ‰€/API)   |     | (LZMAå‹ç¼©ç½‘å…³)  |     | (ä¸€è‡´æ€§å“ˆå¸Œåˆ†ç‰‡) |
+----------------+     +-----------------+     +-----------------+
                               |
                               v
                        +-----------------+
                        |     Consul      |
                        | (é›†ç¾¤åè°ƒ/é«˜å¯ç”¨) |
                        +-----------------+
                               |
     +-------------------------+---------------------+
     |                       |                     |
+---------------+    +---------------+    +---------------+
| å­˜å‚¨èŠ‚ç‚¹A     |    | å­˜å‚¨èŠ‚ç‚¹B     |    | å­˜å‚¨èŠ‚ç‚¹C     |
|-Meta RocksDB  |    |-Meta RocksDB  |    |-Meta RocksDB  |
|-Data RocksDB  |    |-Data RocksDB  |    |-Data RocksDB  |
|(æ—¥çº§CFåˆ†ç¦»)   |    |(æ—¥çº§CFåˆ†ç¦»)   |    |(æ—¥çº§CFåˆ†ç¦»)   |
+---------------+    +---------------+    +---------------+
```

### ğŸ”‘ å…³é”®æŠ€æœ¯ç»„ä»¶

#### 1ï¸âƒ£ ä¸€è‡´æ€§å“ˆå¸Œåˆ†ç‰‡
```lua
-- è™šæ‹ŸèŠ‚ç‚¹é…ç½® (æ¯ä¸ªç‰©ç†èŠ‚ç‚¹160ä¸ªè™šæ‹ŸèŠ‚ç‚¹)
local VIRTUAL_NODES = 160

-- ä»Consulè·å–é›†ç¾¤èŠ‚ç‚¹
local function get_cluster_nodes()
    local resp = consul.get("/stock-tsdb/nodes")
    return json.decode(resp.value)
end

-- æ ¹æ®è‚¡ç¥¨ä»£ç è·¯ç”±
local function route_stock(stock_code)
    local hash = crc32(stock_code)
    local idx = binary_search(hash_ring, hash)
    return hash_ring[idx].physical_node
end
```

#### 2ï¸âƒ£ ZeroMQ + LZMAé€šä¿¡å±‚
```lua
-- LZMAå‹ç¼©çš„ZeroMQé€šä¿¡
local zmq = require("zmq")
local lzma = ffi.load("liblzma")

-- å‘é€å‹ç¼©æ•°æ®
local function send_compressed(socket, data)
    local in_buf = ffi.new("const uint8_t[?]", #data, data)
    local out_buf = ffi.new("uint8_t[?]", #data * 2)
    local out_pos = ffi.new("size_t[1]", 0)
    
    lzma.lzma_easy_buffer_encode(
        9 | lzma.LZMA_PRESET_EXTREME, -- æœ€é«˜å‹ç¼©çº§åˆ«
        lzma.LZMA_CHECK_CRC64,
        nil,
        in_buf, #data,
        out_buf, out_pos, #data * 2
    )
    
    socket:send(ffi.string(out_buf, out_pos[0]))
end
```

#### 3ï¸âƒ£ RocksDBå­˜å‚¨å¼•æ“è®¾è®¡

**Column Familyç»„ç»‡**:
```
MetaDB:
  - stock_metadata: è‚¡ç¥¨å…ƒæ•°æ®
  - shard_mapping: åˆ†ç‰‡æ˜ å°„å…³ç³»  
  - cf_management: ColumnFamilyç”Ÿå‘½å‘¨æœŸç®¡ç†

DataDB (æŒ‰è‡ªç„¶æ—¥åˆ†CF):
  - 20231010: 2023å¹´10æœˆ10æ—¥æ•°æ®
  - 20231011: 2023å¹´10æœˆ11æ—¥æ•°æ®
  - ... (æ¯æ—¥è‡ªåŠ¨åˆ›å»ºæ–°CF)
```

**æ•°æ®å­˜å‚¨æ ¼å¼**:
```lua
-- 30ç§’å®šé•¿å— (30,000,000å¾®ç§’)
local BLOCK_SIZE = 30000000

-- å†™å…¥ç¤ºä¾‹
local function write_tick(stock_code, timestamp, price, volume)
    -- è®¡ç®—å—IDå’Œå¾®ç§’åç§»
    local day_cf = os.date("%Y%m%d", timestamp)
    local day_start = get_day_start(timestamp)
    local block_id = math.floor((timestamp - day_start) / BLOCK_SIZE)
    local micro_offset = (timestamp - day_start) % BLOCK_SIZE
    
    -- é”®æ„é€ 
    local key = string.format("%s:%d:%d", stock_code, block_id, micro_offset)
    
    -- å€¼æ‰“åŒ… (4Bä»·æ ¼ + 4Bæˆäº¤é‡ + 8Bæ ‡å¿—ä½)
    local value = struct.pack("IIQ", price*10000, volume, flags)
    
    -- å†™å…¥å¯¹åº”æ—¥çš„CF
    rocksdb:put(day_cf, key, value)
end
```

#### 4ï¸âƒ£ Consulé«˜å¯ç”¨åè°ƒ
```lua
-- Consulä¸­å­˜å‚¨CFçŠ¶æ€
local CF_STATUS_KEY = "/stock-tsdb/cf_status/"

-- æ¯æ—¥å‡Œæ™¨æ‰§è¡Œæ•°æ®è¿ç§»
local function manage_data_retention()
    local current_day = os.date("%Y%m%d")
    local hot_days = 3 -- ä¿ç•™3å¤©çƒ­æ•°æ®
    
    -- éå†æ‰€æœ‰CF
    for cf_name, cf_handle in pairs(data_db.column_families) do
        if cf_name ~= current_day and tonumber(cf_name) < tonumber(current_day) - hot_days then
            -- æ ‡è®°ä¸ºå†·æ•°æ®
            consul.put(CF_STATUS_KEY..cf_name, "cold")
            
            -- è®¾ç½®å†·æ•°æ®å‹ç¼©ç­–ç•¥
            rocksdb:set_options(cf_handle, {
                compression = "zstd",
                bottommost_compression = "zstd",
                compaction_style = "level"
            })
        end
    end
end
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### ğŸš€ å†™å…¥ä¼˜åŒ–
- **æ‰¹é‡å†™å…¥**: æ¯æ‰¹æ¬¡1000-10000æ¡è®°å½•
- **å¼‚æ­¥WAL**: æ¯1msæ‰¹é‡åˆ·ç›˜
- **å¤šçº¿ç¨‹**: 16çº¿ç¨‹å¹¶å‘å†™å…¥
- **å†…å­˜æ§åˆ¶**: WriteBuffer Size 256MB

### ğŸ” æŸ¥è¯¢ä¼˜åŒ–  
- **Block Cache**: çƒ­ç‚¹æ•°æ®å†…å­˜ç¼“å­˜
- **ç´¢å¼•ç¼“å­˜**: SSTæ–‡ä»¶ç´¢å¼•ç¼“å­˜
- **BloomFilter**: æ¯ä¸ªDataBlockä¸€ä¸ª10bit/hash
- **å®šé•¿å—é¢„åŠ è½½**: é¢„åŠ è½½ç›¸é‚»æ•°æ®å—

### ğŸ—œï¸ å‹ç¼©ä¼˜åŒ–
- **ç½‘ç»œä¼ è¾“**: LZMAæœ€é«˜å‹ç¼©çº§åˆ«
- **å—å†…å‹ç¼©**: LZ4å¿«é€Ÿå‹ç¼©
- **å†·æ•°æ®**: ZSTDé«˜å‹ç¼©æ¯”
- **å‹ç¼©ç‡**: æ•´ä½“è¾¾åˆ°4:1

### ğŸ’¾ å†…å­˜ç®¡ç†
- **FFIå†…å­˜**: ä½¿ç”¨`ffi.gc`ç®¡ç†RocksDBå¯¹è±¡
- **å¯¹è±¡æ± **: é‡ç”¨å¤§å‹ç¼“å†²åŒº
- **å®šæ—¶æ¸…ç†**: å®šæœŸæ¸…ç†è¿‡æœŸç¼“å­˜

---

## ğŸ”§ ç”Ÿäº§çº§ä¼˜åŒ–å»ºè®®

| ç»´åº¦ | ä¼˜åŒ–ç­–ç•¥ |
|------|----------|
| **å†™å…¥æ€§èƒ½** | æ‰¹é‡å†™å…¥ã€å¼‚æ­¥WALã€ZeroMQå¤šçº¿ç¨‹æ¨é€ã€RocksDBè°ƒä¼˜ |
| **è¯»å–æ€§èƒ½** | BlockCacheã€ç´¢å¼•ç¼“å­˜ã€CFçº§BloomFilterã€å®šé•¿å—é¢„åŠ è½½ |
| **å‹ç¼©æ•ˆç‡** | å—å†…ä½¿ç”¨LZMAå‹ç¼©ï¼Œç½‘ç»œä¼ è¾“ä½¿ç”¨Snappy |
| **å†…å­˜ç®¡ç†** | LuaJITä½¿ç”¨`ffi.gc`ç®¡ç†RocksDBå¯¹è±¡ç”Ÿå‘½å‘¨æœŸ |
| **ç›‘æ§è¿ç»´** | é›†æˆPrometheus+Grafanaï¼Œæš´éœ²QPSã€å»¶è¿Ÿã€CFå¤§å°ç­‰æŒ‡æ ‡ |

---

## ğŸ“ ç›¸å…³æ–‡æ¡£ç´¢å¼•

- [V3å­˜å‚¨å¼•æ“å®Œæ•´æŒ‡å—](V3_STORAGE_ENGINE_COMPLETE_GUIDE.md) - ğŸŒŸ **æ¨èä¼˜å…ˆé˜…è¯»**
- [V3ç‰ˆæœ¬å¯¹æ¯”æŠ¥å‘Š](V3_VERSION_COMPARISON_REPORT.md) - è¯¦ç»†æ€§èƒ½å¯¹æ¯”
- [V3é›†æˆç‰ˆæœ¬æ€»ç»“](V3_INTEGRATED_SUMMARY.md) - åˆ†å¸ƒå¼æ¶æ„ç‰¹æ€§
- [ç”Ÿäº§ç¯å¢ƒè„šæœ¬ä½¿ç”¨æŒ‡å—](PRODUCTION_SCRIPTS_GUIDE.md) - å®Œæ•´è¿ç»´æŒ‡å—

---

## ğŸ“ æ€»ç»“

æœ¬æ–‡æ¡£æ•´åˆäº†Stock-TSDBé¡¹ç›®çš„æ ¸å¿ƒæŠ€æœ¯è®¾è®¡ï¼š

1. **é€šç”¨æ€§è®¾è®¡** - "30ç§’å®šé•¿å—+å¾®ç§’åˆ—åç§»"æ¨¡æ¿å¯å¤ç”¨åˆ°å¤šä¸ªæ—¶åºåœºæ™¯
2. **ä¸¤å¥—æ–¹æ¡ˆ** - é’ˆå¯¹ä¸åŒåº”ç”¨åœºæ™¯æä¾›æœ€ä¼˜è§£å†³æ–¹æ¡ˆ
3. **è¯¦ç»†å®ç°** - ä»æ•°æ®æ¨¡å‹åˆ°äºŒè¿›åˆ¶æ‰“åŒ…çš„å®Œæ•´æŠ€æœ¯ç»†èŠ‚
4. **æ¶æ„è®¾è®¡** - æ”¯æŒåˆ†å¸ƒå¼ã€é«˜å¯ç”¨çš„å®Œæ•´ç³»ç»Ÿæ¶æ„
5. **æ€§èƒ½ä¼˜åŒ–** - å…¨æ–¹ä½çš„æ€§èƒ½è°ƒä¼˜ç­–ç•¥

è¿™äº›æŠ€æœ¯æ–¹æ¡ˆå·²åœ¨ç”Ÿäº§ç¯å¢ƒéªŒè¯ï¼Œå…·å¤‡**720ä¸‡ops/sã€4:1å‹ç¼©ã€P99<0.5ms**çš„ä¼˜å¼‚æ€§èƒ½ï¼Œå¯ç›´æ¥ç”¨äºæ„å»ºä¼ä¸šçº§æ—¶åºæ•°æ®åº“ç³»ç»Ÿã€‚